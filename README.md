# 2024-2_ROKEYBOOTCAMP_Collaborative_robot_project_1
2024년 2기 2주차, ROKEY Boot 캠프의 두산기업의 협동 로봇을 제어해서 만드는 프로젝트의 첫 번째입니다.
## code/dosan studio task
  - Tetris : 테트리스를 태블릿(디스플레이)으로 짠 코드이다.
  - task2 : dosan studio으로 기어 조립을 한 코드이다. gear.txt가 DRL(dosan robot language)로 만든 코드이다.
  - task3 : dosan studio으로 블럭 옮기기를 한 코드이다. block.txt가 DRL(dosan robot language)로 만든 코드이다.
## 테트리스 쌓기
- 해당 과제는 크기가 다른 블럭을 쌓는 과제입니다.

https://github.com/user-attachments/assets/389b7055-1b5c-4868-8d94-4f2702a27293

해당 과제는 DRL(Dosan Robot Language)가 아닌 TaskWriter를 작성하여 만든 블럭을 쌓는 Task입니다. 순서 `147147` 을 입력하면 아래 순서도에 있는

  ------------
  7 8 9   
  4 5 6   
  1 2 3   
  ------------
블럭을 들어서 옆에 있는 블럭에 쌓도록 설계하였다. 다른 입력값은 받을 수 없다.
### 핵심
  - 그리퍼의 잡는 힘을 적게 주고, 다른 블럭과 부딪치면서 잡고 있는 블럭이 가로로 누워지도록 하여 쌓도록 한다. 이를 입력한 배열에 따라 해당 위치의 블럭을 쌓는다.
## 유성 기어 조립
- 해당 과제는 3개의 서로 다른 기어 사이에 작은 기어를 넣어 유성 기어를 조립하는 과제이다.

https://github.com/user-attachments/assets/a39daa8a-d8fe-4d30-92f3-6cd0e0cfd857

### 핵심
  - 기어를 내리면서 닿기 전, 위치까지 간 뒤에, 힘 제어를 통해서 충돌이 날 경우, 약간 돈 후, 내려가면 기어가 들어가게 된다. 여기서 생겼던 문제는 처음 기어가 닿기 전까지 갈때 만약 기존 기어에 닿게 된다면, 돌리는 힘이 작기 때문에 로봇이 들고 있는 기어가 돌지 않아서 중앙 기어가 들어가지 않는다. 그러므로 중앙 기어가 기존 기어 3개와 닿지 않도록 위치를 조종한 후, 힘 제어를 해야한다.

## 팔레트 블럭 옮기기
  블럭을 들어서 다른 팔레트에 옮긴다. 중간에 멈추더라도 하던 일을 계속 진행한다.

https://github.com/user-attachments/assets/5e090c9a-0d67-4697-be23-5ba23d3ef25e

  - 위 영상은 처음 정상 동작한 모션 이후, 주먹을 쥐면 프로그램을 멈추고, 다시 실행할 경우, 블럭을 놓고 다시 집으러 가는 경우와 집은 상태의 경우를 각각 인지해서 일을 계속하도록 만들었다.

https://github.com/user-attachments/assets/619dc0a9-f856-446a-b670-57795f3e90e3

  - 위 영상은 잡기 직전 멈추고 실행할 경우, 정상 작동하는 모습이다.
### 핵심
  - 해당 과제는 get_pattern_point라는 내재 함수를 이용해서 팔레트의 배열을 순서대로 접근해서 각각 집도록 한다. 여기서 중요한 것은 중간에 고장이 날 경우, 작동을 멈추는 함수를 쓰레드로 만들어 놓아 예외 시나리오를 대비하고, 추가적으로 하던 일 도중에 멈출 경우 하던 일을 인지하고 계속하도록 만든다.

##  사람과의 협업 작업을 가정하여 안전률을 올리고, 생산 속도까지 확보할 수 있다.
  - 공간 제한 구역 설정 가능 : 유효한 공간에서만 이동 가능
  - 협동작업 구역 설정 가능 : 속도와 민감도를 조정
  - 협착 방지 구역 설정 가능 : 정지 모드를 변경
  - 위 3가지 구역을 설정해서 각각 협동작업 구역은 작은 충격에도 로봇이 멈추고, 로봇 속도를 느리게 한다. 공간 제한 구역은 로봇이 일정 구간을 벗어나면 로봇이 멈춘다. 마지막 협착 방지 구역은 작은 충격에도 바로 로봇이 멈추고, 로봇을 움직이게 할 수 있다.

https://github.com/user-attachments/assets/9cdacf8b-b5c2-4140-a0fc-6c8d7de2bae4

![Image](https://github.com/user-attachments/assets/e548b00e-1665-4d08-92c4-26e9128a7fcb)

  - 위 영상은 협동 작업 구역에 진입시 속도가 느려지고, 이를 그래프로 확인한 이미지이다.

  https://github.com/user-attachments/assets/bf3af221-81ed-4da8-b8ca-d1a008474e22
  
  - 위 영상은 협동 작업 구역에서 충돌이 날 경우, 로봇이 멈추는 영상이다.

  https://github.com/user-attachments/assets/8fbae5df-0944-4f4a-af0b-ee0e3c379833

  - 위 영상은 협착 방지 구역에서 충돌이 날 경우, 로봇이 멈추는 영상이다.

## 협동로봇 시스템을 이해하고 기획하기
  - 공정 하나를 선정하여 시스템을 기획한다.
  - 양식,발표자료,기획서는 자유, 중요한 건 안전 설정, 시스템(정전,멈춤,Estop), 산업 안전 공단의 지침을 따라가면 안전 시스템을 만들 수 있다.
  - 요건 4가지
    1. 안전 정격 감시 정지
    2. 핸드 가이딩
    3. 속도 및 위치 감시 - 안전 구역
    4. 동력-힘 제한 - 충돌
  - 선택 주제 : 참치 해체 공정
    ![Image](https://github.com/user-attachments/assets/a35cfa2e-f1b9-453e-b34a-49cd268538d3)
  - 목적 : 삼치 해체 공정은 인력이 많이 드는 힘겨운 작업이기에 이 삼치 공정의 일부분인 큐브로 자르는 공정을 협동로봇을 통해 인력 사용을 줄인다.
  - 기능 : 사용자가 티칭을 해서 참치의 큐브를 자르거나 UI를 통해 설정을 하면 지정된 곳을 이동하며 자르도록 한다.
  - 오른쪽 보라색 페달을 밞아야 로봇과 로봇 톱이 작동할 수 있다.
  - 산업안정공단 표준 가이드    
    3. 비상정지장치 설치 : 사용자가 빨간 비상 페달을 밞으면 로봇이 긴급 정지를 하고, UI를 통해 풀어야 로봇이 재작동 된다.     
    4. 협동작업 형태 기능 확인 : 티칭을 통해 로봇에 가해지는 압력 50N과 페달을 잡고 있어야 톱이 동작한다.    
    5. 로봇의 협동 영역 표시 : 초록색이 협동 작업 구역, 노란색은 안전 영역, 갈색(회색)은 협착 공간 영역으로 둔다.    
    6. 협동작업 및 그 위험에 관한 사항을 평가하여 작업자에게 주지 : 빨간 페달은 멈추는 것, 다시 작동할 때 UI로 설정해야한다. 참치를 해체할 때 참치가 튈 수 있으므로 안면 마스크와 고글을 착용한다. 참치를 회전할 땐 로봇 페달과 로봇을 건들지 않도록 한다.    
    7. 안전성능 등 확인 : 위에 적은 안면 마스크와 고글, 참치 해체시 그 주위에 판막이와 매트를 통해 튀는 참치 찌꺼기가 작업장이 더럽혀지지 않도록 한다.    
    8. 제어기 조작을 위한 별도의 잠금장치 혹은 비밀번호 설정 : UI를 통해 전원을 키지 않으면 동작하지 않게 한다.    
    9. 협동작업 영역의 정리 상태 :위에서 말한 판막이와 매트를 통해 작업장의 청결을 유지한다. 또한 로봇에 비닐을 씌워서 이물질이 끼지않도록 한다.    
    피드백 : 톱이 협동 작업 구역에 사람이 들어갈 수 있으니 커버 같은 것을 통해 사람이 협동로봇에 들어오면 커버가 닫히고, 일할 때는 열리는 형태로 안전성을 높일 수 있다.
## 느낀점
|이름|느낀 점|
|-----|-----|
|[최범석](https://github.com/ausudu)|더미|
|[이선우](https://github.com/malenwater)| 로봇으로 기획을 할 때, 안정성(사용자의 UI, 제어), 수익성(나라마다 다르다.)라는 것을 배울 수 있었다. 또한 힘제어, 순응 제어 개념과 협동 로봇의 move, gripper를 제어하는 과제를 하면서 기본적인 로봇 제어를 할 수 있었다. 이 제어를 두산 스튜디오, 혹은 두산 플랫폼을 이용해 작업할 수 있어서 좋았다. 결국에는 로봇을 제어하기 위해서는 로봇의 API(메뉴얼)을 읽고 숙지하고 있어야 어떤 식으로 구현할 지를 고려할 수 있다는 것을 느꼈다. 다른 팀원들의 발표를 보면서 아이디어를 내고, 아이디어의 안정성과 수익성, 어떤 방식으로 동작하게 할 것 인가를 고려해야한다는 걸 배웠다. 문제점이 인간이 할 때와 로봇이 할 때, 수익성은 어디서 나고 어떤 문제점을 해결하는지를 고려하고, 피자 만드는 로봇, 창문 닦는 로봇, 벌집 제거 로봇, 휴대폰 필름 붙이기등 다양한 아이디어를 들으며 광고 효과, 다른 국가에서 수익성, 안정성등을 고려하며 기획할 수 있는 수업이었다.|
|[한건희](https://github.com/ghgue)|더미|
|[김영수](https://github.com/youngsoo-kim-123)|더미|
